var re=Object.defineProperty;var se=(s,e,a)=>e in s?re(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var F=(s,e,a)=>se(s,typeof e!="symbol"?e+"":e,a);import{A as O,l as t,j as ne,b7 as oe,r as C,P as X,B as x,T as g,aH as V,aQ as Z,aI as L,aF as z,b8 as q,aW as D,b0 as ee,aL as ie,aM as ce,b9 as Y,ba as $,bb as le,a$ as de,aY as ue,b3 as me,bc as ge}from"./index-CJvNJrNc.js";import{D as N}from"./Divider-PJ21Hh_t.js";import{D as K,a as he}from"./DatePicker-BOfNIeCV.js";import{C as pe}from"./Checkbox-DoL7cOhw.js";import"./dateViewRenderers-Dyjez1Wh.js";const ye=O(t.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),Q=O(t.jsx("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1m-1 9h-4v-7h4z"})),fe=O(t.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),xe=O(t.jsx("path",{d:"M17 7h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.43-.98 2.63-2.31 2.98l1.46 1.46C20.88 15.61 22 13.95 22 12c0-2.76-2.24-5-5-5m-1 4h-2.19l2 2H16zM2 4.27l3.11 3.11C3.29 8.12 2 9.91 2 12c0 2.76 2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1 0-1.59 1.21-2.9 2.76-3.07L8.73 11H8v2h2.73L13 15.27V17h1.73l4.01 4L20 19.74 3.27 3z"})),we=O(t.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),Se=O(t.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"})),J=[{id:"break",name:"Break",icon:"â˜•",color:"#ff9800",targetType:"none",isActive:!1,totalTime:0,createdAt:new Date},{id:"work",name:"Work",icon:"ðŸ’¼",color:"#2196f3",targetType:"none",isActive:!1,totalTime:0,createdAt:new Date}],H={dailyTargetHours:8,workdays:[1,2,3,4,5],vacationDays:[],trackingStartDate:new Date().toISOString().split("T")[0],lastUpdatedAt:new Date().toISOString()},ve="time-tracker-db",E="fsHandles",W="configFile";function G(){return new Promise((s,e)=>{const a=indexedDB.open(ve,1);a.onupgradeneeded=()=>{const r=a.result;r.objectStoreNames.contains(E)||r.createObjectStore(E)},a.onsuccess=()=>s(a.result),a.onerror=()=>e(a.error)})}async function je(s){const e=await G();return new Promise((a,r)=>{const l=e.transaction(E,"readonly").objectStore(E).get(s);l.onsuccess=()=>a(l.result),l.onerror=()=>r(l.error)})}async function be(s,e){const a=await G();return new Promise((r,o)=>{const c=a.transaction(E,"readwrite").objectStore(E).put(e,s);c.onsuccess=()=>r(),c.onerror=()=>o(c.error)})}async function Te(s){const e=await G();return new Promise((a,r)=>{const l=e.transaction(E,"readwrite").objectStore(E).delete(s);l.onsuccess=()=>a(),l.onerror=()=>r(l.error)})}async function B(){try{return await je(W)??null}catch{return null}}async function Ce(s){await be(W,s)}async function De(){await Te(W)}async function U(s,e="readwrite",a=!1){var l,c;const r={mode:e};return await((l=s.queryPermission)==null?void 0:l.call(s,r))==="granted"?!0:a?await((c=s.requestPermission)==null?void 0:c.call(s,r))==="granted":!1}const b={isAvailable(){return typeof window<"u"&&"showSaveFilePicker"in window&&window.isSecureContext},async getStatus(){var r;if(!this.isAvailable())return{connected:!1};const s=await B();if(!s)return{connected:!1};const e=await((r=s.queryPermission)==null?void 0:r.call(s,{mode:"readwrite"}));return{connected:e==="granted"||e==="prompt",fileName:s.name,permission:e}},async connect(){if(!this.isAvailable())return{connected:!1};const s=await window.showSaveFilePicker({suggestedName:"time-tracker-data.json",types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]});return await U(s,"readwrite",!0)?(await Ce(s),{connected:!0,fileName:s.name}):{connected:!1}},async disconnect(){await De()},async mirrorState(s){var i,l;if(!this.isAvailable())return;const e=await B();if(!e||!await U(e,"readwrite",!1))return;console.log("Mirror: About to write state:",{projectsCount:((i=s.projects)==null?void 0:i.length)||0,entriesCount:((l=s.timeEntries)==null?void 0:l.length)||0,hasSettings:!!s.settings});const r=JSON.stringify(s,null,2);console.log("Mirror: JSON length:",r.length);const o=await e.createWritable();await o.write(r),await o.close(),console.log("Mirror: Write completed")},async tryImportState(){if(!this.isAvailable())return null;const s=await B();if(!s||!await U(s,"read",!1))return null;const r=await(await s.getFile()).text();try{return JSON.parse(r)}catch{return null}}},p={PROJECTS:"timeTracker_projects",TIME_ENTRIES:"timeTracker_timeEntries",ACTIVE_PROJECT:"timeTracker_activeProject",PAUSED_PROJECT:"timeTracker_pausedProject",SETTINGS:"timeTracker_settings",CURRENT_SESSION:"timeTracker_currentSession",MIGRATION_VERSION:"timeTracker_migrationVersion"};class y{static isAvailable(){var e,a;return!!((a=(e=window.browser)==null?void 0:e.storage)!=null&&a.sync)}static async get(e){if(this.isAvailable())try{return(await window.browser.storage.sync.get([e]))[e]||null}catch(a){return console.warn("Sync storage get failed, falling back to localStorage:",a),localStorage.getItem(e)}else return localStorage.getItem(e)}static async set(e,a){if(this.isAvailable())try{await window.browser.storage.sync.set({[e]:a})}catch(r){console.warn("Sync storage set failed, falling back to localStorage:",r),localStorage.setItem(e,a)}else localStorage.setItem(e,a)}static async remove(e){if(this.isAvailable())try{await window.browser.storage.sync.remove([e])}catch(a){console.warn("Sync storage remove failed, falling back to localStorage:",a),localStorage.removeItem(e)}else localStorage.removeItem(e)}static async getMultiple(e){if(this.isAvailable())try{return await window.browser.storage.sync.get(e)}catch(a){console.warn("Sync storage getMultiple failed, falling back to localStorage:",a);const r={};return e.forEach(o=>{const i=localStorage.getItem(o);i!==null&&(r[o]=i)}),r}else{const a={};return e.forEach(r=>{const o=localStorage.getItem(r);o!==null&&(a[r]=o)}),a}}static isSyncAvailable(){return this.isAvailable()}}class v{static scheduleMirrorWrite(){this.mirrorDirty=!0,this.mirrorTimer&&clearTimeout(this.mirrorTimer),this.mirrorTimer=window.setTimeout(async()=>{var e,a;try{if(!this.mirrorDirty)return;this.mirrorDirty=!1;const r=await this.loadAppState();console.log("Storage: Loaded state for mirror:",{projectsCount:((e=r.projects)==null?void 0:e.length)||0,entriesCount:((a=r.timeEntries)==null?void 0:a.length)||0});const o=JSON.stringify(r);o!==this.lastMirroredString?(console.log("Storage: State changed, mirroring..."),await b.mirrorState(r),this.lastMirroredString=o):console.log("Storage: State unchanged, skipping mirror")}catch(r){console.warn("File mirror (debounced) failed:",r)}},2e3)}static mergeTimeEntries(e,a){const r=new Map,o=i=>r.set(i.id,i);e.forEach(o);for(const i of a){const l=r.get(i.id);if(!l){r.set(i.id,i);continue}const c=l.duration??0,m=i.duration??0,j=l.endTime?new Date(l.endTime).getTime():0,w=i.endTime?new Date(i.endTime).getTime():0;r.set(i.id,m>c||w>j?i:l)}return Array.from(r.values()).map(i=>({...i,startTime:new Date(i.startTime),endTime:i.endTime?new Date(i.endTime):void 0}))}static mergeSettings(e,a){const r=e.lastUpdatedAt?new Date(e.lastUpdatedAt).getTime():0;return(a.lastUpdatedAt?new Date(a.lastUpdatedAt).getTime():0)>=r?{...e,...a}:e}static mergeProjects(e,a){const r=new Map;e.forEach(o=>r.set(o.id,o));for(const o of a){const i=r.get(o.id);if(!i){r.set(o.id,o);continue}const l={...i,...o,totalTime:Math.max(i.totalTime,o.totalTime),createdAt:new Date(Math.min(new Date(i.createdAt).getTime(),new Date(o.createdAt).getTime()))};r.set(o.id,l)}return Array.from(r.values()).map(o=>({...o,createdAt:new Date(o.createdAt)}))}static recomputeProjectTotals(e,a){return e.map(r=>({...r,totalTime:ne(r.id,a)}))}static async loadProjects(){const e=await y.get(p.PROJECTS);return e?JSON.parse(e).map(r=>({...r,createdAt:new Date(r.createdAt)})):(await this.saveProjects(J),J)}static async saveProjects(e){await y.set(p.PROJECTS,JSON.stringify(e))}static async loadTimeEntries(){const e=await y.get(p.TIME_ENTRIES);return e?JSON.parse(e).map(r=>({...r,startTime:new Date(r.startTime),endTime:r.endTime?new Date(r.endTime):void 0})):[]}static async saveTimeEntries(e){await y.set(p.TIME_ENTRIES,JSON.stringify(e))}static async loadSettings(){const e=await y.get(p.SETTINGS);if(e){const a=JSON.parse(e);return{...H,...a,vacationDays:a.vacationDays||[],lastUpdatedAt:a.lastUpdatedAt||new Date().toISOString()}}return await this.saveSettings(H),H}static async saveSettings(e){const a={...e,lastUpdatedAt:new Date().toISOString()};await y.set(p.SETTINGS,JSON.stringify(a))}static async loadActiveProject(){return await y.get(p.ACTIVE_PROJECT)}static async saveActiveProject(e){e?await y.set(p.ACTIVE_PROJECT,e):await y.remove(p.ACTIVE_PROJECT)}static async loadPausedProject(){return await y.get(p.PAUSED_PROJECT)}static async savePausedProject(e){e?await y.set(p.PAUSED_PROJECT,e):await y.remove(p.PAUSED_PROJECT)}static async loadCurrentSession(){const e=await y.get(p.CURRENT_SESSION);return e?new Date(e):null}static async saveCurrentSession(e){e?await y.set(p.CURRENT_SESSION,e.toISOString()):await y.remove(p.CURRENT_SESSION)}static async loadAppState(){const[e,a,r,o,i,l]=await Promise.all([this.loadProjects(),this.loadTimeEntries(),this.loadActiveProject(),this.loadPausedProject(),this.loadSettings(),this.loadCurrentSession()]);let c={projects:e,timeEntries:a,activeProjectId:r,pausedProjectId:o,settings:i,currentSessionStart:l};try{const m=await y.get(p.MIGRATION_VERSION),j=m?parseInt(m,10):0;if(!Number.isFinite(j)||j<this.CURRENT_MIGRATION_VERSION){let w=!1;const P=c.projects.some(u=>u.id==="break"),R=c.projects.some(u=>u.id==="work"),T=J.reduce((u,I)=>(u[I.id]=I,u),{});let S=c.projects.slice();!P&&T.break&&(S=[T.break,...S],w=!0),!R&&T.work&&(S=[T.work,...S],w=!0),S=S.map(u=>{if(u.id==="break"||u.id==="work"){const I=T[u.id];return{...u,targetType:"none",icon:u.icon||I.icon,color:u.color||I.color}}return u});const k=this.recomputeProjectTotals(S,c.timeEntries);for(let u=0;u<S.length;u++)if(S[u].totalTime!==k[u].totalTime){w=!0;break}w&&(c={...c,projects:k},await this.saveAppState(c)),await y.set(p.MIGRATION_VERSION,String(this.CURRENT_MIGRATION_VERSION))}}catch(m){console.warn("Migration check failed:",m)}return c}static async saveAppState(e){const a=[];e.projects&&a.push(this.saveProjects(e.projects)),e.timeEntries&&a.push(this.saveTimeEntries(e.timeEntries)),e.activeProjectId!==void 0&&a.push(this.saveActiveProject(e.activeProjectId)),e.pausedProjectId!==void 0&&a.push(this.savePausedProject(e.pausedProjectId)),e.settings&&a.push(this.saveSettings(e.settings)),e.currentSessionStart!==void 0&&a.push(this.saveCurrentSession(e.currentSessionStart)),await Promise.all(a),this.scheduleMirrorWrite()}static async tryImportFromMirror(){try{return await b.tryImportState()}catch(e){return console.warn("Import from file mirror failed:",e),null}}}F(v,"CURRENT_MIGRATION_VERSION",1),F(v,"mirrorDirty",!1),F(v,"mirrorTimer"),F(v,"lastMirroredString","");function Ee(s){switch(s){case"connected":return"success";case"connecting":return"primary";case"syncing":return"primary";case"error":return"error";default:return"default"}}function Ie(s){switch(s){case"connected":return"Connected";case"connecting":return"Connecting...";case"syncing":return"Syncing...";case"error":return"Error";default:return"Disconnected"}}function Ae(){const{syncState:s,syncCode:e,startSync:a,setSyncCode:r,clearSyncCode:o,generateSyncCode:i}=oe(),[l,c]=C.useState(""),[m,j]=C.useState(!1),[w,P]=C.useState(!1),R=async()=>{e&&(await navigator.clipboard.writeText(e),j(!0),setTimeout(()=>j(!1),2e3))},T=async()=>{P(!0);try{const u=await i();await a(u)}finally{P(!1)}},S=async()=>{l.trim()&&(await r(l.trim().toUpperCase()),c(""))},k=async()=>{await o()};return t.jsxs(X,{sx:{p:2,mb:3},children:[t.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[t.jsx(Q,{color:"primary"}),t.jsx(g,{variant:"h6",children:"Device Sync (P2P)"}),t.jsx(V,{size:"small",label:Ie(s.status),color:Ee(s.status),sx:{ml:"auto"}})]}),t.jsx(g,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Sync your data between devices using peer-to-peer WebRTC. No server stores your data - it travels directly between your devices."}),s.lastError&&t.jsx(Z,{severity:"error",sx:{mb:2},children:s.lastError}),e?t.jsxs(x,{children:[t.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Your Sync Code"}),t.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1,mb:2,p:2,bgcolor:"grey.100",borderRadius:1},children:[t.jsx(g,{variant:"h5",sx:{fontFamily:"monospace",fontWeight:"bold",letterSpacing:2,flex:1},children:e}),t.jsx(L,{title:m?"Copied!":"Copy code",children:t.jsx(z,{onClick:R,size:"small",children:t.jsx(ye,{})})}),t.jsx(L,{title:"Generate new code",children:t.jsx(z,{onClick:T,size:"small",disabled:w,children:w?t.jsx(q,{size:20}):t.jsx(we,{})})})]}),t.jsx(x,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:t.jsx(V,{icon:t.jsx(Q,{}),label:`${s.peerCount} peer${s.peerCount!==1?"s":""} connected`,variant:"outlined",color:s.peerCount>0?"success":"default"})}),t.jsx(g,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Enter this code on your other devices to sync. Changes will sync automatically in real-time."}),t.jsx(D,{variant:"outlined",color:"warning",startIcon:t.jsx(xe,{}),onClick:k,children:"Disconnect Sync"})]}):t.jsxs(x,{children:[t.jsx(x,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"}},children:t.jsx(D,{variant:"contained",startIcon:w?t.jsx(q,{size:20,color:"inherit"}):t.jsx(fe,{}),onClick:T,disabled:w,sx:{flex:1},children:"Create Sync Code"})}),t.jsx(N,{sx:{my:2},children:t.jsx(g,{variant:"body2",color:"text.secondary",children:"or join existing"})}),t.jsxs(x,{sx:{display:"flex",gap:1},children:[t.jsx(ee,{size:"small",placeholder:"Enter sync code (e.g., ABC-123-XYZ)",value:l,onChange:u=>c(u.target.value.toUpperCase()),sx:{flex:1},inputProps:{style:{fontFamily:"monospace",textTransform:"uppercase"}}}),t.jsx(D,{variant:"outlined",onClick:S,disabled:!l.trim(),children:"Join"})]})]})]})}const Pe=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],_e=({settings:s,onSave:e})=>{const[a,r]=C.useState(s),[o,i]=C.useState(null),[l,c]=C.useState({open:!1,message:"",severity:"info"}),[m,j]=C.useState(null);C.useEffect(()=>{r(s)},[s]),C.useEffect(()=>{let n=!0;return(async()=>{const d=await b.getStatus();n&&j({connected:d.connected,fileName:d.fileName})})(),()=>{n=!1}},[]);const w=()=>{e(a),c({open:!0,message:"Settings saved successfully!",severity:"success"})},P=(n,d)=>{let f;d?f=[...a.workdays,n].sort((h,M)=>h-M):f=a.workdays.filter(h=>h!==n),r(h=>({...h,workdays:f}))},R=()=>{if(o){const n=$(o);a.vacationDays.includes(n)||r(d=>({...d,vacationDays:[...d.vacationDays,n].sort()})),i(null)}},T=n=>{r(d=>({...d,vacationDays:d.vacationDays.filter(f=>f!==n)}))},S=async()=>{try{const n=await v.loadAppState(),d=JSON.stringify(n,null,2),f=new Blob([d],{type:"application/json"}),h=document.createElement("a");h.href=URL.createObjectURL(f),h.download=`time-tracker-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),c({open:!0,message:"Data exported successfully!",severity:"success"})}catch{c({open:!0,message:"Failed to export data",severity:"error"})}},k=n=>{var h;const d=(h=n.target.files)==null?void 0:h[0];if(!d)return;const f=new FileReader;f.onload=M=>{var _;try{const A=JSON.parse((_=M.target)==null?void 0:_.result);if(!A.projects||!A.timeEntries||!A.settings)throw new Error("Invalid data format");v.saveAppState(A),window.location.reload()}catch{c({open:!0,message:"Failed to import data. Please check the file format.",severity:"error"})}},f.readAsText(d),n.target.value=""},u=async()=>{if(!b.isAvailable()){c({open:!0,message:"File System Access API not available (needs HTTPS).",severity:"error"});return}const n=await b.connect();if(j(n),n.connected){c({open:!0,message:`Connected to ${n.fileName}`,severity:"success"});try{const d=await v.loadAppState(),f=await b.tryImportState();if(f){console.log("Found existing data in file, merging...");const h=v.mergeTimeEntries(d.timeEntries,f.timeEntries||[]),M=v.mergeSettings(d.settings,f.settings),_=v.mergeProjects(d.projects,f.projects||[]),A=v.recomputeProjectTotals(_,h),ae={...d,projects:A,timeEntries:h,settings:M};await b.mirrorState(ae),window.location.reload(),c({open:!0,message:`Connected and merged existing data from ${n.fileName}`,severity:"success"})}else console.log("File is empty or invalid, writing current state..."),await b.mirrorState(d),c({open:!0,message:`Connected to ${n.fileName} and saved current data`,severity:"success"});console.log("Initial mirror setup completed")}catch(d){console.warn("Initial mirror setup failed:",d),c({open:!0,message:"Connected but failed to sync data",severity:"error"})}}else c({open:!0,message:"Connection canceled or permission denied.",severity:"info"})},I=async()=>{await b.disconnect(),j({connected:!1}),c({open:!0,message:"Disconnected external file",severity:"info"})},te=async()=>{const n=await v.tryImportFromMirror();n?(await v.saveAppState(n),window.location.reload()):c({open:!0,message:"No data available from external file.",severity:"info"})};return t.jsx(ie,{dateAdapter:ce,children:t.jsxs(x,{sx:{p:2},children:[t.jsx(g,{variant:"h5",gutterBottom:!0,children:"Settings"}),t.jsx(Ae,{}),t.jsxs(x,{sx:{py:2},children:[t.jsx(g,{variant:"h6",gutterBottom:!0,children:"Work Schedule"}),t.jsx(ee,{label:"Daily Target Hours",type:"number",value:a.dailyTargetHours,onChange:n=>r(d=>({...d,dailyTargetHours:parseFloat(n.target.value)||0})),fullWidth:!0,margin:"normal",inputProps:{min:0,max:24,step:.5},helperText:"Target working hours per day"}),t.jsx(N,{sx:{my:3}}),t.jsx(g,{variant:"h6",gutterBottom:!0,children:"Time Tracking Start Date"}),t.jsx(g,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Set the date you started tracking time. This will adjust target calculations for the first month."}),t.jsx(K,{label:"Tracking Start Date",value:Y(a.trackingStartDate),onChange:n=>{n&&r(d=>({...d,trackingStartDate:$(n)}))},slotProps:{textField:{fullWidth:!0,margin:"normal"}}}),t.jsx(N,{sx:{my:3}}),t.jsx(g,{variant:"h6",gutterBottom:!0,children:"Working Days"}),t.jsx(g,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Select which days of the week you typically work"}),t.jsx(le,{children:Pe.map(n=>t.jsx(de,{control:t.jsx(pe,{checked:a.workdays.includes(n.value),onChange:d=>P(n.value,d.target.checked)}),label:n.label},n.value))}),t.jsx(N,{sx:{my:3}}),t.jsx(g,{variant:"h6",gutterBottom:!0,children:"Vacation Days"}),t.jsx(g,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Add vacation days or days off. These will be excluded from target calculations."}),t.jsxs(x,{sx:{display:"flex",gap:2,alignItems:"flex-end",mb:2},children:[t.jsx(K,{label:"Add Vacation Day",value:o,onChange:n=>i(n),slotProps:{textField:{size:"small",sx:{flex:1}}}}),t.jsx(z,{onClick:R,disabled:!o,color:"primary",children:t.jsx(ue,{})})]}),t.jsxs(x,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:[a.vacationDays.map(n=>t.jsx(V,{label:Y(n).toLocaleDateString(),onDelete:()=>T(n),deleteIcon:t.jsx(me,{}),variant:"outlined"},n)),a.vacationDays.length===0&&t.jsx(g,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:"No vacation days added"})]}),t.jsx(N,{sx:{my:3}}),t.jsx(g,{variant:"h6",gutterBottom:!0,children:"Data Management"}),t.jsx(g,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Export your data for backup or import from another device"}),t.jsxs(X,{sx:{p:2,mb:3},children:[t.jsxs(x,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"}},children:[t.jsx(D,{variant:"outlined",startIcon:t.jsx(he,{}),onClick:S,sx:{flex:1},children:"Export All Data"}),t.jsxs(D,{variant:"outlined",component:"label",startIcon:t.jsx(Se,{}),sx:{flex:1},children:["Import Data",t.jsx("input",{type:"file",accept:".json",onChange:k,hidden:!0})]})]}),t.jsx(g,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Use export/import to transfer data between devices or create backups"}),t.jsx(N,{sx:{my:2}}),t.jsx(g,{variant:"subtitle1",gutterBottom:!0,children:"External File Mirror (beta)"}),t.jsx(g,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Mirror your data to a chosen JSON file (requires HTTPS and a browser that supports the File System Access API). Store the file in a synced folder (e.g. Google Drive) for cross-device access."}),t.jsxs(x,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"}},children:[t.jsx(D,{variant:"outlined",onClick:u,disabled:!b.isAvailable(),sx:{flex:1},children:m!=null&&m.connected?"Change Fileâ€¦":"Connect File Mirrorâ€¦"}),t.jsx(D,{variant:"outlined",color:"warning",onClick:I,disabled:!(m!=null&&m.connected),sx:{flex:1},children:"Disconnect"}),t.jsx(D,{variant:"outlined",color:"primary",onClick:te,disabled:!(m!=null&&m.connected),sx:{flex:1},children:"Import from Mirror"})]}),t.jsx(g,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:b.isAvailable()?m!=null&&m.connected?`Connected: ${m.fileName}`:"Not connected":"Not available (use HTTPS)."})]}),t.jsx(x,{sx:{mt:3,p:2,backgroundColor:"grey.50",borderRadius:1},children:t.jsxs(g,{variant:"body2",color:"text.secondary",children:[t.jsx("strong",{children:"Note:"})," These settings affect overtime calculations and progress tracking. Monthly targets are calculated automatically based on working days minus vacation days."]})}),t.jsx(x,{sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:t.jsx(D,{onClick:w,variant:"contained",size:"large",children:"Save Settings"})})]}),t.jsx(ge,{open:l.open,autoHideDuration:3e3,onClose:()=>c(n=>({...n,open:!1})),children:t.jsx(Z,{onClose:()=>c(n=>({...n,open:!1})),severity:l.severity,children:l.message})})]})})};export{_e as SettingsPanel};
